import { Observable } from '@tanbo/stream';
import { Injector } from '@tanbo/di';
import { NativeSelectionBridge, NativeSelectionConnector, Renderer, SelectionPosition, AbstractSelection, RootComponentRef, Controller, Selection } from '@textbus/core';
import { Rect } from '../_utils/uikit';
import { Input, ViewOptions } from './types';
/**
 * Textbus PC 端选区桥接实现
 */
export declare class SelectionBridge implements NativeSelectionBridge {
    private config;
    private injector;
    private controller;
    private selection;
    private rootComponentRef;
    private input;
    private renderer;
    onSelectionChange: Observable<Range | null>;
    nativeSelection: globalThis.Selection;
    private selectionMaskElement;
    private selectionChangeEvent;
    private subs;
    private sub;
    private connector;
    private ignoreSelectionChange;
    private changeFromUser;
    private docContainer;
    private maskContainer;
    private cacheCaretPositionTimer;
    private oldCaretPosition;
    constructor(config: ViewOptions, injector: Injector, controller: Controller, selection: Selection, rootComponentRef: RootComponentRef, input: Input, renderer: Renderer);
    connect(connector: NativeSelectionConnector): void;
    disConnect(): void;
    getRect(location: SelectionPosition): Rect | null;
    restore(abstractSelection: AbstractSelection | null, formLocal: boolean): void;
    destroy(): void;
    getPositionByRange(abstractSelection: AbstractSelection): {
        focus: {
            node: Node;
            offset: number;
        } | null;
        anchor: {
            node: Node;
            offset: number;
        } | null;
    };
    getPreviousLinePositionByCurrent(position: SelectionPosition): SelectionPosition | null;
    getNextLinePositionByCurrent(position: SelectionPosition): SelectionPosition | null;
    private getLinePosition;
    /**
     * 获取选区向上移动一行的位置。
     * @param currentPosition
     * @param startLeft 参考位置。
     */
    private getPreviousLinePositionByOffset;
    /**
     * 获取选区向下移动一行的位置。
     * @param currentPosition
     * @param startLeft 参考位置。
     */
    private getNextLinePositionByOffset;
    private unListen;
    private listen;
    private syncSelection;
    private findSelectedNodeAndOffset;
    private getCorrectedPosition;
    private findFocusNode;
    private findFocusNodeByParent;
}
